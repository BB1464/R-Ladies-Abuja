<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Communicating Data Insights with Visuals using ggplot2</title>
    <meta charset="utf-8" />
    <meta name="author" content="Research Fellow, IITA R-Ladies Abuja" />
    <script src="libs/header-attrs-2.13.1/header-attrs.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, top, title-slide

# Communicating Data Insights with Visuals using ggplot2
## Oluwafemi Oyedele
### Research Fellow, IITA<br>R-Ladies Abuja
### Mar 26, 2022<br>Updated: Mar 24, 2022

---



## About me

.left-column[
&lt;img src="img/pix.jpg" width="2385" style="display: block; margin: auto auto auto 0;" /&gt;
]

.right-column[

- I am a Agrometeorologist and Crop Simulation modeler

- I am a member of R4DS online learning community

- I am also a active member of the TidyTuesday project

- I love reading books in my spare time

- <svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>: [Oluwafemi Oyedele](https://www.linkedin.com/in/oluwafemioyedele/) 

- <svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>: [@OluwafemOyedele](https://twitter.com/OluwafemOyedele) üëç

- <svg aria-hidden="true" role="img" viewBox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>:
[https://github.com/BB1464](https://github.com/BB1464)

- <svg aria-hidden="true" role="img" viewBox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"/></svg>: [https://statisticalinference.netlify.app](https://statisticalinference.netlify.app) üòÑ

]
---

# **Agenda**

- Introduction to the Grammar of Graphics

- We will be looking at the different layers that is in ggplot2

- The focus of this talk will be on the 20% that is useful 80% of the time

- More in-depth coverage is available via resources I will release later.
  
- **My goal is to make you excited about ggplot2!**


- I will entertain **questions** at the end



- **Github link to get the materials**: https://github.com/BB1464/R-Ladies-Abuja
---
# Grammar of Graphics
.pull-right[![](img/wilkinson.jpeg)]
.pull-left[

- First published in 1999

- Foundation for many graphic applications

- Grammar can be applied to every type of plot

- Concisely describe components

- A theoretical deconstruction of data graphics


.pull-left[![](img/ggplot2.png)]
]
---
# Packages Used Today

This workshop focuses on data visualization with  [`ggplot2`](https://ggplot2.tidyverse.org).

--

`ggplot2` is a system for declaratively creating graphics, based on The Grammar of Graphics. You provide the data, tell `ggplot2` how to map variables to `aesthetics`, what graphical primitives to use, and it takes care of the details.


--

You can install `ggplot2` with the following:


```r
install.packages("ggplot2")
```

 Or the development version from GitHub:


```r
install.packages("devtools")
```


```r
devtools::install_github("tidyverse/ggplot2")
```


```r
library(ggplot2)
```
---
# Grammar of Graphics
![](img/tom1.png)
---
# Grammar of Graphics
.pull-right[![](img/tom_data.png)]

- Your dataset

- Tidy format

- There is no visualization without a dataset

---
# Grammar of Graphics
.pull-right[![](img/tom_mapping.png)]

- **Aesthetics mapping** links variable in the data to graphical properties in the geometry.

- We can specify the following properties within the aestetic mapping (colour, shape, alpha, fill, size).

---
# Grammar of Graphics
.pull-right[![](img/tom_statistics.png)]

- Even tidy data may need some transformation

- The statistics is linked to the geometry

- Every geometry has a default statistics and vice versa

- Transform input variables to displayed values:
  
  - Bins for histogram
  
  - Summary statistics for boxplot using `stat_boxplot()`
  
  - No. of observations in a category for bar chart `stat_count`
---
# Grammar of Graphics
.pull-right[![](img/tom_scales.png)]

-  Scales also provide the tools that let you interpret the plot: the axes and legends.


- Scales help us to control the mapping from data to aesthetics


- Understanding the underpinning of scales will help us to customize our visualization

- Scales are automatically generated in ggplot and can be customized
  - log scale
  - We can also specify limit within the scale


- Scales help you interpret the plot
  - Categories -&gt; color
  - Numeric -&gt; position

---
# Grammar of Graphics
.pull-right[![](img/tom_geometries.png)]

- Geometries help us to interpret the aesthetics as graphical repersentation

- Determines your plot type
  - bar chart
  - scatter
  - boxplot
  - histogram
  - ...
---

# Grammar of Graphics
.pull-right[![](img/tom_facets.png)]

- Divide your data into panels using one or two groups

- Allows you to look at smaller subsets of data

---
# Grammar of Graphics
.pull-right[![](img/tom_coordinates.png)]

- A coordinate system, maps the position of objects onto the plane of the plot.

- It is also the physical mapping of the aestetics to the paper

- Coordinate systems affect all position variables simultaneously and differ from scales in that they also change the appearance of the geometric objects.

- Coordinate systems control how the axes and grid lines are drawn.

---
# Grammar of Graphics
.pull-right[![](img/tom_theme.png)]

- This controls the overall look of the plot

- Spans every part of the graphic that is not linked to the data

- Themes give you control over things like fonts, ticks, panel strips, and backgrounds
---

![](img/horst_ggplot.jpeg)
---

- `The Data Layer` specifies the data being plotted
.center[
![](img/ge_data.png)
]


```r
                   head(iris,2)
```

```
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
```


```r
                 ggplot(data = iris)
```

&lt;img src="index_files/figure-html/unnamed-chunk-5-1.png" style="display: block; margin: auto;" /&gt;
---
# Aestetic Mapping

- `Aestetic Mapping`: This layer specifies how we want to map our data onto the scales of the plot

- To set a geometric property manually, place it outside of `aes()`

- The name of a color as a character string

- The size of a point

- The shape of a point as a number

---
- `Aestetic` properties in R
&lt;img src="img/common-aesthetics-1.png" width="1536" style="display: block; margin: auto;" /&gt;
---
- Shapes that are available in R
&lt;img src="img/shapes-1.png" width="1792" style="display: block; margin: auto;" /&gt;
---

```r
                    ggplot(data = iris,
                    mapping = aes(
                     x = Sepal.Length,
                     y =  Sepal.Width,
                     colour=Species,shape=Species),
                     alpha=0.5
                      ) 
```

&lt;img src="index_files/figure-html/unnamed-chunk-8-1.png" style="display: block; margin: auto;" /&gt;
---
# Geoms
`ggplot2` has 53 `geoms` at the moments but we are going to look at just few geoms today. But I will release some useful resources at the end where you can learn further on what is not covered here.
- We can view all the geoms with this function below

```r
apropos('^geom_')
```

```
##  [1] "geom_abline"            "geom_area"              "geom_bar"              
##  [4] "geom_bin_2d"            "geom_bin2d"             "geom_blank"            
##  [7] "geom_boxplot"           "geom_col"               "geom_contour"          
## [10] "geom_contour_filled"    "geom_count"             "geom_crossbar"         
## [13] "geom_curve"             "geom_density"           "geom_density_2d"       
## [16] "geom_density_2d_filled" "geom_density2d"         "geom_density2d_filled" 
## [19] "geom_dotplot"           "geom_errorbar"          "geom_errorbarh"        
## [22] "geom_freqpoly"          "geom_function"          "geom_hex"              
## [25] "geom_histogram"         "geom_hline"             "geom_jitter"           
## [28] "geom_label"             "geom_line"              "geom_linerange"        
## [31] "geom_map"               "geom_path"              "geom_point"            
## [34] "geom_pointrange"        "geom_polygon"           "geom_qq"               
## [37] "geom_qq_line"           "geom_quantile"          "geom_raster"           
## [40] "geom_rect"              "geom_ribbon"            "geom_rug"              
## [43] "geom_segment"           "geom_sf"                "geom_sf_label"         
## [46] "geom_sf_text"           "geom_smooth"            "geom_spoke"            
## [49] "geom_step"              "geom_text"              "geom_tile"             
## [52] "geom_violin"            "geom_vline"
```
---
# Scatter Plot

```r
                    ggplot(data = iris,
                    mapping = aes(
                     x = Sepal.Length,
                     y =  Sepal.Width,
                     colour=Species,shape=Species),
                     alpha=0.5
                      )+
                     geom_point()
```

&lt;img src="index_files/figure-html/unnamed-chunk-10-1.png" style="display: block; margin: auto;" /&gt;
---
- Removing the colour from the mapping

```r
                 ggplot(data = iris,
       mapping = aes(
           x = Sepal.Length,
           y =  Sepal.Width,shape=Species))+
    geom_point(colour='blue')
```

&lt;img src="index_files/figure-html/unnamed-chunk-11-1.png" style="display: block; margin: auto;" /&gt;
---
&lt;img src="img/tom_need1.png" width="1735" style="display: block; margin: auto;" /&gt;
---

```r
ggplot(data=faithful) + 
  geom_point(aes(x = eruptions, y = waiting, colour = eruptions &lt; 3))
```

&lt;img src="index_files/figure-html/unnamed-chunk-13-1.png" style="display: block; margin: auto;" /&gt;
---
# Bar Plot

```r
                    ggplot(data = iris,
                    mapping = aes(
                     x = Species,
                     fill=Species)
                      )+
                     geom_bar(width = 0.7)
```

&lt;img src="index_files/figure-html/unnamed-chunk-14-1.png" style="display: block; margin: auto;" /&gt;
---
# Bar plot

```r
                    ggplot(data = iris,
                    mapping = aes(
                     x = Species,
                     y= Sepal.Length,
                     fill=Species)
                      )+
                     geom_bar(width = 0.9)
```

```
## Error in `f()`:
## ! stat_count() can only have an x or y aesthetic.
```

&lt;img src="index_files/figure-html/unnamed-chunk-15-1.png" style="display: block; margin: auto;" /&gt;
---
- This shows the proportion for each cut

```r
ggplot(data = diamonds,mapping = aes(x = color,y=price,fill=cut))+
  geom_col(position = 'fill')
```

&lt;img src="index_files/figure-html/unnamed-chunk-16-1.png" style="display: block; margin: auto;" /&gt;
---
- This shows the proportion of the cut

```r
ggplot(data = diamonds,mapping = aes(x = reorder(color,price,FUN=mean),y=price,fill=cut))+
  geom_bar(stat='summary',fun=mean)+xlab('Diamond quality')
```

&lt;img src="index_files/figure-html/unnamed-chunk-17-1.png" style="display: block; margin: auto;" /&gt;

---
# Box Plot `geom_boxplot()`

```r
                   ggplot(data = iris,
                    mapping = aes(
                     x = Species,
                     y =  Sepal.Width,
                     fill=Species))+
                      geom_boxplot()+geom_jitter()+
                      stat_summary(fun = mean,geom =             
                      'point',shape=23,fill='white',size=2.5)
```

&lt;img src="index_files/figure-html/unnamed-chunk-18-1.png" style="display: block; margin: auto;" /&gt;
---
# Histogram : `geom_histogram`

```r
                   ggplot(data = iris)+
                   geom_histogram(
                     mapping = aes(x = Sepal.Length,fill=Species)
                     )
```

```
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
```

&lt;img src="index_files/figure-html/unnamed-chunk-19-1.png" style="display: block; margin: auto;" /&gt;
---
- Default behavior of `goem_histogram` is equivalent to the following.

```r
ggplot(iris, aes(x = Sepal.Length, y = after_stat(count),fill=Species)) + geom_histogram()
```

```
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
```

&lt;img src="index_files/figure-html/unnamed-chunk-20-1.png" style="display: block; margin: auto;" /&gt;
---
- line graph with`stat_summary`

```r
ggplot(data = economics,mapping = aes(x = date,y = uempmed))+
  stat_summary(fun = mean,geom = 'line')
```

&lt;img src="index_files/figure-html/unnamed-chunk-21-1.png" style="display: block; margin: auto;" /&gt;
---
# Density Plot

```r
ggplot(diamonds, aes(depth, fill = cut, colour = cut)) +
  geom_density(alpha = 0.2, na.rm = TRUE)
```

&lt;img src="index_files/figure-html/unnamed-chunk-22-1.png" style="display: block; margin: auto;" /&gt;
---
# Violin Plot

```r
ggplot(data = iris,mapping = aes(x = Sepal.Length,y = Petal.Length,fill=Species))+geom_violin()
```

```
## Warning: position_dodge requires non-overlapping x intervals
```

&lt;img src="index_files/figure-html/unnamed-chunk-23-1.png" style="display: block; margin: auto;" /&gt;
---
- `Statistics`

- Statistical transformations,  summaries the data: for example, binning and counting observations to create a histogram, or fitting a linear model.

- The statistics layer allows you plot statistical values calculated from the data

- The function below shows the number of statistics available in ggplot2

```r
apropos('^stat_')
```

```
##  [1] "stat_bin"               "stat_bin_2d"            "stat_bin_hex"          
##  [4] "stat_bin2d"             "stat_binhex"            "stat_boxplot"          
##  [7] "stat_contour"           "stat_contour_filled"    "stat_count"            
## [10] "stat_density"           "stat_density_2d"        "stat_density_2d_filled"
## [13] "stat_density2d"         "stat_density2d_filled"  "stat_ecdf"             
## [16] "stat_ellipse"           "stat_function"          "stat_identity"         
## [19] "stat_qq"                "stat_qq_line"           "stat_quantile"         
## [22] "stat_sf"                "stat_sf_coordinates"    "stat_smooth"           
## [25] "stat_spoke"             "stat_sum"               "stat_summary"          
## [28] "stat_summary_2d"        "stat_summary_bin"       "stat_summary_hex"      
## [31] "stat_summary2d"         "stat_unique"            "stat_ydensity"
```
---
`Statistics`:`stat_boxplot`

```r
                   ggplot(data = iris,
                    mapping = aes(
                     x = reorder(Species,Sepal.Width,FUN=median),
                     y =  Sepal.Width,
                     fill=Species))+
                      stat_boxplot(geom = 'errorbar')+
                      geom_boxplot(notch = TRUE)+geom_jitter()+
                      stat_summary(fun = mean,geom =             
                      'point',shape=23,fill='white',size=2.5)+xlab('Species')
```

&lt;img src="index_files/figure-html/unnamed-chunk-25-1.png" style="display: block; margin: auto;" /&gt;
---
- Statistical Transformation for bar plot
&lt;img src="img/visualization-stat-bar.png" width="3867" style="display: block; margin: auto;" /&gt;

- You can find out which `stat` each `geom` uses by looking at the default value of the `stat` argument of the help page.

- What it the default `stat` for `geom_bar`?
---
- Values calculated by the stat is available with the `after_stat()` function 
inside `aes()`. You can do all sorts of computations inside that.


```r
ggplot(mpg) + 
  geom_bar(aes(x = class, y = after_stat(100 * count / sum(count))))
```

&lt;img src="index_files/figure-html/unnamed-chunk-27-1.png" style="display: block; margin: auto;" /&gt;
---
- `after_scale` function

```r
   ggplot(mpg, aes(class, hwy)) +
  geom_boxplot(aes(fill = stage(class, after_scale = alpha(fill, 0.4))))
```

&lt;img src="index_files/figure-html/unnamed-chunk-28-1.png" style="display: block; margin: auto;" /&gt;
---
- Bar plot with error bars to show the level of uncertainty around the mean

```r
                          ggplot(data=diamonds,aes(x = cut, y = price)) +
                          stat_summary(
                          geom = "bar",
                          fun = "mean",
                          alpha = .6
                          ) +
                          stat_summary(
                          geom = "errorbar",
                          fun.data = "mean_se",
                          width = .2
                          ) +
                         stat_summary(
                         geom = "point",
                         fun = "mean"
                         )
```

&lt;img src="index_files/figure-html/unnamed-chunk-29-1.png" style="display: block; margin: auto;" /&gt;
---
- Scatter plot showing the mean data point in red

```r
ggplot(mpg)+
  geom_jitter(mapping = aes(x = class,y = hwy),width = 0.2)+
  stat_summary(mapping = aes(x = class,y=hwy),fun = mean,geom='point',colour='red')
```

&lt;img src="index_files/figure-html/unnamed-chunk-30-1.png" style="display: block; margin: auto;" /&gt;
---
- Here I added the best fit line alongside with the 95% confidence interval

```r
ggplot(mpg, aes(x = cty, y = displ)) +
    geom_point(alpha = 0.4, size = 2) +
    scale_x_log10() + geom_smooth(method = "lm")
```

```
## `geom_smooth()` using formula 'y ~ x'
```

&lt;img src="index_files/figure-html/unnamed-chunk-31-1.png" style="display: block; margin: auto;" /&gt;
---

```r
iris |&gt;
  ggplot(aes(x = Species,
             y = Sepal.Length))+
  stat_summary(geom = 'pointrange',fun.max = max,fun.min = min,fun = mean)
```

&lt;img src="index_files/figure-html/unnamed-chunk-32-1.png" style="display: block; margin: auto;" /&gt;
---
# `Scales`

- `Scales` in ggplot2 control the mapping from data to aesthetics. They take your data and turn it into something that you can see, like size, colour, position or shape. 

- `Scales` also provide the tools that let you interpret the plot: the axes and legends. You can generate plots with ggplot2 without knowing how scales work, but understanding scales and learning how to manipulate them will give you much more control.

---
 - `ggplot2 has a total of 122 scales` but hear I choose to only show the first 50.


```r
apropos('^scale_')|&gt; head(n=50)
```

```
##  [1] "scale_alpha"             "scale_alpha_binned"     
##  [3] "scale_alpha_continuous"  "scale_alpha_date"       
##  [5] "scale_alpha_datetime"    "scale_alpha_discrete"   
##  [7] "scale_alpha_identity"    "scale_alpha_manual"     
##  [9] "scale_alpha_ordinal"     "scale_color_binned"     
## [11] "scale_color_brewer"      "scale_color_continuous" 
## [13] "scale_color_date"        "scale_color_datetime"   
## [15] "scale_color_discrete"    "scale_color_distiller"  
## [17] "scale_color_fermenter"   "scale_color_gradient"   
## [19] "scale_color_gradient2"   "scale_color_gradientn"  
## [21] "scale_color_grey"        "scale_color_hue"        
## [23] "scale_color_identity"    "scale_color_manual"     
## [25] "scale_color_ordinal"     "scale_color_steps"      
## [27] "scale_color_steps2"      "scale_color_stepsn"     
## [29] "scale_color_viridis_b"   "scale_color_viridis_c"  
## [31] "scale_color_viridis_d"   "scale_colour_binned"    
## [33] "scale_colour_brewer"     "scale_colour_continuous"
## [35] "scale_colour_date"       "scale_colour_datetime"  
## [37] "scale_colour_discrete"   "scale_colour_distiller" 
## [39] "scale_colour_fermenter"  "scale_colour_gradient"  
## [41] "scale_colour_gradient2"  "scale_colour_gradientn" 
## [43] "scale_colour_grey"       "scale_colour_hue"       
## [45] "scale_colour_identity"   "scale_colour_manual"    
## [47] "scale_colour_ordinal"    "scale_colour_steps"     
## [49] "scale_colour_steps2"     "scale_colour_stepsn"
```
---
# `Modifying scales`
- A scale is required for every aesthetic used on the plot. When you write:
 

```r
                   ggplot(mpg, aes(displ, hwy)) + 
                   geom_point(aes(colour = class))
```

&lt;img src="index_files/figure-html/unnamed-chunk-33-1.png" style="display: block; margin: auto;" /&gt;
---
 `What actually happens is this:`

```r
                   ggplot(mpg, aes(displ, hwy)) + 
                    geom_point(aes(colour = class)) +
                    scale_x_continuous() + 
                    scale_y_continuous() + 
                    scale_colour_discrete()
```

&lt;img src="index_files/figure-html/unnamed-chunk-34-1.png" style="display: block; margin: auto;" /&gt;
---
`placing the x axis on log10`

```r
                 ggplot(mpg, aes(displ, hwy,colour=class)) + 
                 geom_point() + 
                 scale_x_log10()
```

&lt;img src="index_files/figure-html/unnamed-chunk-35-1.png" style="display: block; margin: auto;" /&gt;
---
`Modifying the colour of the scatter plot using scale_colour_discrete`

```r
           ggplot(data = mpg,mapping = aes(x = displ,y = hwy,colour=class))+
           geom_point()+
           scale_color_brewer(name='Class',palette = 'Set1')
```

&lt;img src="index_files/figure-html/unnamed-chunk-36-1.png" style="display: block; margin: auto;" /&gt;
---
- Here I specified that the type should be qualitative but we can also use sequencial or diverging

```r
ggplot(mpg) + 
  geom_point(aes(x = displ, y = hwy, colour = class)) + 
  scale_colour_brewer(type = 'qual')
```

&lt;img src="index_files/figure-html/unnamed-chunk-37-1.png" style="display: block; margin: auto;" /&gt;
---
`Modifying the colour of the bar plot`

```r
          ggplot(data = iris, mapping = aes(x = Species,fill=Species)) +
          geom_bar()+
          scale_fill_brewer(name='Species',palette = 'Dark2')
```

&lt;img src="index_files/figure-html/unnamed-chunk-38-1.png" style="display: block; margin: auto;" /&gt;
---
- Here I placed the y axis on log 10 and then I specified the breaks for the y axis

```r
ggplot(mpg) + 
  geom_point(aes(x = displ, y = hwy)) + 
  scale_x_continuous(breaks = c(3, 5, 6)) + 
  scale_y_continuous(trans = 'log10')
```

&lt;img src="index_files/figure-html/unnamed-chunk-39-1.png" style="display: block; margin: auto;" /&gt;

---
`How to supply manual colour to ggplot2`

```r
          ggplot(data = mpg,mapping = aes(x = displ,y = hwy,colour=class))+
          geom_point()+
         scale_colour_manual(name='Class',values =                      
                               c('red','blue','green','cyan',
                                                                     
                                 'gray50','pink','black'))
```

&lt;img src="index_files/figure-html/unnamed-chunk-40-1.png" style="display: block; margin: auto;" /&gt;
---
`How to creat breaks in the x axis`

```r
ggplot(data = economics,mapping = aes(x = date,y = unemploy))+
  geom_line()+
  scale_x_date(date_breaks = '10 years')
```

&lt;img src="index_files/figure-html/unnamed-chunk-41-1.png" style="display: block; margin: auto;" /&gt;
---
- Supplying labels to the x axis 

```r
      ggplot(data = iris, mapping = aes(x =Species,fill=Species))+
      geom_bar()+
      scale_fill_brewer(name='Species',palette='Dark2')+
      scale_x_discrete(name='Species',
      labels=c('setosa\n(N=50)','versicolor\n(N=50)','virginica\n(N=50)'))
```

&lt;img src="index_files/figure-html/unnamed-chunk-42-1.png" style="display: block; margin: auto;" /&gt;
---
- Coordinate system in `ggplot2`
- The coordinate system, describes how data coordinates are mapped to the plane of the graphic. It also provides axes and grid lines to help read the graph. We normally use the Cartesian coordinate system, but a number of others are available, including polar coordinates and map projections.

- We can view all the available coordinate system with the function below

```r
apropos('^coord_')
```

```
##  [1] "coord_cartesian" "coord_equal"     "coord_fixed"     "coord_flip"     
##  [5] "coord_map"       "coord_munch"     "coord_polar"     "coord_quickmap" 
##  [9] "coord_sf"        "coord_trans"
```
---
- `Pie Chart with coord_polar()`

```r
df &lt;- data.frame(Group=c('Tall','Short','Average'),Height=c(14,30,45))

df |&gt;
  dplyr::mutate(Percentage=round(prop.table(Height)*100,1)) |&gt;
  ggplot(aes(x = '',y = Percentage,fill=Group))+
  geom_bar(stat = 'identity',width = 1)+
  coord_polar(theta = 'y',direction = 1)+
  geom_text(aes(label=paste0(Percentage,'%')),position = position_stack(vjust = 0.5))+
  theme_void()+
  scale_fill_brewer(palette = 'Set1')
```

&lt;img src="index_files/figure-html/unnamed-chunk-44-1.png" style="display: block; margin: auto;" /&gt;
---
- We can zoom into the plot within the `coord_cartesian` by just specifying the limit

```r
ggplot(mpg) + 
  geom_bar(aes(x = class)) + 
  coord_cartesian(ylim = c(0, 40))
```

&lt;img src="index_files/figure-html/unnamed-chunk-45-1.png" style="display: block; margin: auto;" /&gt;
---
- We can ensure that the x and y axis start from zero

```r
ggplot(mpg) + 
  geom_bar(aes(x = class)) + 
  coord_cartesian(ylim = c(0, 40),expand=expansion(mult = 0,add = 0))
```

```
## Warning in if (!expand) {: the condition has length &gt; 1 and only the first
## element will be used

## Warning in if (!expand) {: the condition has length &gt; 1 and only the first
## element will be used
```

&lt;img src="index_files/figure-html/unnamed-chunk-46-1.png" style="display: block; margin: auto;" /&gt;
---
![](img/visualization-coordinate-systems.png)
---
# Facetting
- The facet defines how data is split among panels. The default facet 
(`facet_null()`) puts all the data in a single panel, while `facet_wrap()` and
`facet_grid()` allows you to specify different types of small multiples


- The function below shows the number of facet available in `ggplot2`

```r
apropos('^facet_')
```

```
## [1] "facet_grid" "facet_null" "facet_wrap"
```
---
`facet_wrap`

```r
                ggplot(data = mpg)+ 
                geom_point(mapping = aes(x = displ, y = hwy)) + 
                facet_wrap(~ class, nrow = 2)
```

&lt;img src="index_files/figure-html/unnamed-chunk-48-1.png" style="display: block; margin: auto;" /&gt;
---
`facet_grid`

```r
                  ggplot(data = mpg) + 
                  geom_point(mapping = aes(x = displ, y = hwy)) + 
                  facet_grid(drv ~ cyl)
```

&lt;img src="index_files/figure-html/unnamed-chunk-49-1.png" style="display: block; margin: auto;" /&gt;
---
# Themes
- `The Themes Layer` refers to all non-data ink:
- Any text element can be modified with element_text()

- Any line element can be modified with element_line()

- Any rect element can be modified with element_rect()


```r
length(theme_get())
```

```
## [1] 93
```

```r
theme_get() |&gt; head(1)
```

```
## $line
## List of 6
##  $ colour       : chr "black"
##  $ size         : num 0.5
##  $ linetype     : num 1
##  $ lineend      : chr "butt"
##  $ arrow        : logi FALSE
##  $ inherit.blank: logi TRUE
##  - attr(*, "class")= chr [1:2] "element_line" "element"
```
---
- To get the default argument for plot title in `ggplot2`

```r
theme_get()$plot.title
```

```
## List of 11
##  $ family       : NULL
##  $ face         : NULL
##  $ colour       : NULL
##  $ size         : 'rel' num 1.2
##  $ hjust        : num 0
##  $ vjust        : num 1
##  $ angle        : NULL
##  $ lineheight   : NULL
##  $ margin       : 'margin' num [1:4] 0points 0points 5.5points 0points
##   ..- attr(*, "unit")= int 8
##  $ debug        : NULL
##  $ inherit.blank: logi TRUE
##  - attr(*, "class")= chr [1:2] "element_text" "element"
```
---
- Theming defines the feel and look of your final visualization and is something you will normally defer to the final polishing of the plot. It is very easy to change looks with a prebuild theme

```r
ggplot(mpg) + 
  geom_bar(aes(y = class)) + 
  facet_wrap(~year) + 
  theme_minimal()
```

&lt;img src="index_files/figure-html/unnamed-chunk-52-1.png" style="display: block; margin: auto;" /&gt;
---
- Further adjustments can be done in the end to get exactly the look you want


```r
ggplot(mpg)+geom_bar(aes(y = class))+facet_wrap( ~ year)+
  labs(
    title = "Number of car models per class",
    caption = "source:http://fueleconomy.gov",
    x = NULL, y = NULL
  )+ scale_x_continuous(expand = c(0, NA))+theme_minimal()+
  theme(
    text = element_text('Avenir Next Condensed'),
    strip.text = element_text(face = 'bold', hjust = 0),
    plot.caption = element_text(face = 'italic'),
    panel.grid.major= element_line('white', size = 0.5),
    panel.grid.minor=element_blank(),
    panel.grid.major.y = element_blank(),
    panel.ontop=TRUE
  )
```

&lt;img src="index_files/figure-html/unnamed-chunk-53-1.png" style="display: block; margin: auto;" /&gt;
---
![](img/theme_elements.png)
---
# Saving the plot

```r
ggsave('plot.name.png',plot = last_plot,width = 9,height = 6,units = 'cm',dpi = 450)
```
---
# Resources
   * [ggplot2: Elegant Graphics for Data Analysis](https://ggplot2-book.org/introduction.html) This is a very good resources to learn data visualization and it was written by Hadley Wickham the author of `ggplot2`

   * [ggplot2 website](http://ggplot2.tidyverse.org/) 
   
   * [R for Data Science](http://r4ds.had.co.nz/) online textbook by Garrett Grolemund and Hadley Wickham. One of many good R texts available, but importantly it is free and focuses on the [`tidyverse`](http://tidyverse.org/) collection of R packages which are the modern standard for data manipulation and visualization in R.
   
   * [Advanced R](http://adv-r.had.co.nz/) online textbook by Hadley Wickham. A great source for more in-depth and advanced R programming.
   
   * [Useful RStudio cheatsheets](https://www.rstudio.com/resources/cheatsheets/) on `ggplot2`.
   
   * [Fundamentals of Data Visualization](https://book4you.org/book/5618179/8693c0) This is a very good book written by Claus O. Wilke which talks about data Visualization in R using the tidyverse philosophy

   * [Storytelling with Data](https://book4you.org/book/19209707/be7fa6) This book is a data visualization guide for business professional written by Cole Nussbaumer Knaflic
  
---
# Acknowledgement
Special thanks to all the people who made this tutorial a success:

**@R-Ladies Abuja** organisers for giving me the opportunity to present this talk


Thanks to **Yihui Xie** for *{knitr}* and *{xaringan}* and **Garrick Aden-Buie** for *{xaringanthemer}*

I will also like to thank **Thomas Lin Pedersen** for giving a great talk on plotting anything with ggplot2 and this also inspired my talk.

Slides for this talk was created with the [**xaringan package**](https://github.com/yihui/xaringan)
---
class: middle, center, hide-logo, question
background-image: url(https://upload.wikimedia.org/wikipedia/commons/3/39/Naruto_Shiki_Fujin.svg)
background-size: contain

# Questions


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "tomorrow-night-bright",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
